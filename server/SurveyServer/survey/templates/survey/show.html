{%load static%}
<!DOCTYPE htm>
<html>

<head>
    <meta charset="utf-8" />
    <script src="http://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
    <script src="http://code.highcharts.com/highcharts.js"></script>
</head>

<body>
    <div id="result"></div>
    <div id="container" style="width: 550px; height: 400px; margin: 0 auto"></div>
</body>
<script type="text/javascript">
    var chart = {
        plotBackgroundColor: null,
        plotBorderWidth: null,
        plotShadow: false
    };
    var tooltip = {
        pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
    };
    var plotOptions = {
        pie: {
            allowPointSelect: true,
            cursor: 'pointer',
            dataLabels: {
                enabled: true,
                format: '<b>{point.name}%</b>: {point.percentage:.1f} %',
                style: {
                    color: (Highcharts.theme && Highcharts.theme.contrastTextColor) || 'black'
                }
            }
        }
    };
    var result = {{ result| safe}}
    for (i in result["questions"]) {
        var question = result["questions"][i]
        var ele = document.createElement("div")
        var desc = question["description"]
        ele.innerHTML = '<div class="descrition">' + desc + '</div>' + '<div class="graph"></div>'

        eleResult = document.getElementById("result")
        eleResult.appendChild(ele)

        var series = [{
            type: 'pie',
            name: 'answer ratio',
            data: []
        }];
        for (j in question['options']) {
            option = question['options'][j]
            series[0]['data'].push([option['description'], option['count']])
        }
        var title = {
            text: ''
        };

        var json = {};
        json.chart = chart;
        json.title = title;
        json.tooltip = tooltip;
        json.series = series;
        json.plotOptions = plotOptions;
        $('#container').highcharts(json);

    }




</script>

</html>